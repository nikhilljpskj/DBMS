name: Auto Commit

on:
  schedule:
    - cron: "*/3 * * * *"

jobs:
  auto-commit:
    runs-on: windows-latest

    steps:
    - name: Checkout Repository
      uses: actions/checkout@v2

    - name: Set Git Config
      run: |
        git config user.email "nikhiljp.skj@gmail.com"
        git config user.name "nikhilljpskj"

    - name: Run Your Script
      run: |
        Set-Content -Path "autogenerated.txt" -Value "Auto-generated file: $(Get-Date -Format 'yyyy-MM-dd HH:mm:ss')"
        
        # Check if there are changes
        if (-not (git status --porcelain)) {
          Write-Host "No changes to commit."
        }
        else {
          git add .
          git commit -m "Auto commit: $(Get-Date -Format 'yyyy-MM-dd HH:mm:ss')"
          git push -u origin HEAD
        }
      env:
        GH_TOKEN: ${{ secrets.DBMS_ACCESS }}
